import{d as e,T as t,l as a,i as n,j as s}from"./main-DASOBCDl.js";function i(e,t,a){if(!t||!a||a<=0)return{error:"Please select an item and enter a target value!"};const n=e.items?.items.find(e=>e.id===t);if(!n)return{error:"Item not found"};if(!n.scaling_per_stack||0===n.scaling_per_stack.length)return{error:"Item has no scaling data"};let s=0;const i=n.scaling_per_stack[0]??null;if(null===i||"number"!=typeof i||!Number.isFinite(i)||i<=0)return{error:"Invalid scaling value"};const l=i;s=Math.ceil(a/l);const c=null!=n.stack_cap&&s>n.stack_cap;c&&(s=n.stack_cap);const r=s*l,o=!0===n.one_and_done,d=!1===n.stacks_well;return{item:n,target:a,stacksNeeded:s,perStack:l,actualValue:r,isCapped:c,isOneAndDone:o,hasWarning:o||d||c}}function l(){const t=document.getElementById("calc-item-select");if(!t||!e.items?.items)return;for(;t.options.length>1;)t.remove(1);e.items.items.filter(e=>e.scaling_per_stack&&e.scaling_per_stack.length>0).forEach(e=>{const a=document.createElement("option");a.value=e.id,a.textContent=e.name,t.appendChild(a)})}function c(){const n=document.getElementById("calc-item-select"),s=document.getElementById("calc-target"),i=document.getElementById("calc-result");if(!n||!s||!i)return;const l=n.value,c=parseFloat(s.value);if(!l)return void(i.style.display="none");if(isNaN(c)||c<=0)return void t.warning("Please enter a valid target value");const r=e.items?.items?.find(e=>e.id===l);if(!r||!r.scaling_per_stack||0===r.scaling_per_stack.length)return void t.error("Item not found or has no scaling data");let o=0;const d=r.scaling_per_stack[0]??null;if(null===d||"number"!=typeof d||!Number.isFinite(d)||d<=0)return void t.warning("Invalid scaling value for this item");o=Math.ceil(c/d);const u=null!=r.stack_cap&&o>r.stack_cap;u&&(o=r.stack_cap);const g=o*d,p={itemName:r.name,perStack:d,targetValue:c,stacksNeeded:o,formula:r.formula||"No formula available",scalingType:r.scaling_type||"",stackCap:r.stack_cap,oneAndDone:r.one_and_done,stacksWell:r.stacks_well,scalingPerStack:r.scaling_per_stack};a.info({operation:"calculator.compute",success:!0,data:{itemId:r.id,itemName:r.name,targetValue:c,result:{stacksNeeded:o,perStack:d,actualValue:g,isCapped:u,isOneAndDone:!0===r.one_and_done}}}),function(e){const t=document.getElementById("calc-result");if(!t)return;const a=e.scalingType.includes("chance")||e.scalingType.includes("percentage"),n=a?"%":"",s=e.stackCap&&e.stackCap>0?e.scalingPerStack.slice(0,e.stackCap):e.scalingPerStack,i=s.length>0?Math.max(...s):1,l=i>0?i:1,c=s.map((t,a)=>{const n=t/l*100;return`<div class="bar-container">\n                        <div class="bar ${a+1===e.stacksNeeded||e.stacksNeeded>s.length&&a===s.length-1?"highlight":""}" style="height: ${n}%"></div>\n                        <div class="bar-label">${a+1}</div>\n                    </div>`}).join("");t.style.display="block",t.innerHTML=`\n        <div class="calc-result-content">\n            <h3>üìä Calculation Result</h3>\n            <div class="result-main">\n                <div class="result-item">\n                    <div class="result-label">Item:</div>\n                    <div class="result-value"><strong>${e.itemName}</strong></div>\n                </div>\n                <div class="result-item">\n                    <div class="result-label">Target Value:</div>\n                    <div class="result-value"><strong>${e.targetValue}${n}</strong></div>\n                </div>\n                <div class="result-item highlight">\n                    <div class="result-label">Stacks Needed:</div>\n                    <div class="result-value large"><strong>${e.stacksNeeded}</strong></div>\n                </div>\n            </div>\n\n            <div class="result-details">\n                <p><strong>Formula:</strong> ${e.formula}</p>\n                <p><strong>Per Stack:</strong> +${e.perStack}${n}</p>\n                ${e.stackCap?`<p class="warning">‚ö†Ô∏è Note: This item caps at ${e.stackCap} stacks</p>`:""}\n                ${e.oneAndDone?'<p class="warning">‚ö†Ô∏è Note: This is a one-and-done item - additional copies provide no benefit!</p>':""}\n                ${!1===e.stacksWell?'<p class="warning">‚ö†Ô∏è Note: This item has diminishing returns or limited stacking</p>':""}\n            </div>\n\n            <div class="result-graph">\n                <h4>Scaling Visualization (1-${s.length} stacks${e.stackCap?`, capped at ${e.stackCap}`:""})</h4>\n                <div class="mini-bar-graph">\n                    ${c}\n                </div>\n            </div>\n        </div>\n    `}(p)}function r(e,t){n("switchTab","calculator"),s("calc-item-select",e),void 0!==t&&t>0&&(s("calc-target",t.toString()),setTimeout(()=>{c()},100))}export{c as calculateBreakpoint,i as computeBreakpoint,l as populateCalculatorItems,r as quickCalc};
//# sourceMappingURL=calculator-l7V4Gfa9.js.map
