import{a as e,d as n,k as t,e as a,m as s}from"./main-DAA4nTv8.js";function i(e,t){switch(e){case"item":return n.items?.items?.find(e=>e.id===t)||null;case"weapon":return n.weapons?.weapons?.find(e=>e.id===t)||null;case"tome":return n.tomes?.tomes?.find(e=>e.id===t)||null;case"character":return n.characters?.characters?.find(e=>e.id===t)||null;case"shrine":return n.shrines?.shrines?.find(e=>e.id===t)||null;default:return null}}function c(e){if(!e)return"";return e.replace(/\[\[(\w+):([\w-]*)\|([^\]]+)\]\]/g,(e,n,t,s)=>{if(!["item","weapon","tome","character","shrine"].includes(n))return s;if(!i(n,t))return a(s);const c=a(n),r=a(t),o=a(s);return`<a href="#" class="entity-link"\n                   data-entity-type="${c}"\n                   data-entity-id="${r}"\n                   title="View ${o}">${o}</a>`})}function r(e){return{balance:"Balance Changes",new_content:"New Content",bug_fixes:"Bug Fixes",removed:"Removed",other:"Other Changes"}[e]||e}function o(e){if(!e)return"";const n=new Date(e+"T00:00:00Z");return isNaN(n.getTime())?"Invalid Date":n.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",timeZone:"UTC"})}function l(e,n){if(!e)return n?`<div class="changelog-raw-notes">${c(a(n))}</div>`:"";const t=["new_content","balance","bug_fixes","removed","other"].map(n=>{const t=e[n];if(!t||0===t.length)return"";const a=t.map(e=>`\n            <div class="changelog-item ${e.change_type||""}">\n                ${c(e.text)}\n            </div>\n        `).join("");return`\n            <div class="changelog-section">\n                <div class="changelog-section-title">${r(n)}</div>\n                ${a}\n            </div>\n        `}).join("");return!t.trim()&&n?`<div class="changelog-raw-notes">${c(a(n))}</div>`:t}function d(n){const i=e("changelogContainer");if(!i)return;if(i.innerHTML="",!n||0===n.length)return void(i.innerHTML=t("ðŸ“‹","Changelog Entries"));const c=n[0]?.date?o(n[0].date):"Unknown",d=document.createElement("header");d.className="changelog-page-header",d.innerHTML=`\n        <h2 class="changelog-page-title">ðŸ“‹ MegaBonk Changelog</h2>\n        <p class="changelog-page-subtitle">Official game updates and patch notes</p>\n        <div class="changelog-page-stats">\n            <span>${n.length} patches</span>\n            <span>â€¢</span>\n            <span>Latest: ${c}</span>\n        </div>\n    `,i.appendChild(d),n.forEach(e=>{const n=document.createElement("article");n.className="changelog-entry",n.dataset.patchId=e.id;const t=Object.entries(e.categories||{}).filter(([e,n])=>n&&n.length>0).map(([e,n])=>({cat:e,count:n.length})).map(({cat:e,count:n})=>`<span class="category-pill ${e}">${r(e).split(" ")[0]} (${n})</span>`).join("");n.innerHTML=`\n            <div class="changelog-header">\n                <span class="changelog-version">v${a(e.version)}</span>\n                <h3 class="changelog-title">${a(e.title)}</h3>\n                <span class="changelog-date">${o(e.date)}</span>\n                ${e.steam_url&&s(e.steam_url)?`\n                    <a href="${a(e.steam_url)}" target="_blank" rel="noopener" class="changelog-steam-link">\n                        ðŸ”— Steam\n                    </a>\n                `:""}\n            </div>\n            <p class="changelog-summary">${a(e.summary||"")}</p>\n            <div class="changelog-categories">${t}</div>\n            <div class="changelog-changes" id="changes-${e.id}">\n                ${l(e.categories,e.raw_notes)}\n            </div>\n            <button class="changelog-expand-btn" data-target="changes-${e.id}"\n                    aria-expanded="false" aria-controls="changes-${e.id}">\n                Show Details\n            </button>\n        `,i.appendChild(n)}),i.removeEventListener("click",g),i.addEventListener("click",g)}function g(e){const n=e.target.closest(".changelog-expand-btn");n&&h(n)}function h(n){const t=n.dataset.target;if(!t)return;const a=e(t);if(!a)return;a.classList.contains("expanded")?(a.classList.remove("expanded"),n.textContent="Show Details",n.setAttribute("aria-expanded","false")):(a.classList.add("expanded"),n.textContent="Hide Details",n.setAttribute("aria-expanded","true"))}function u(t){const a=e("item-count");if(!a)return;const s=n.changelog?.patches?.length||0,i=t?.length||0;a.textContent=i===s?`${i} patches`:`${i}/${s} patches`}export{i as findEntityInData,r as formatCategoryName,o as formatChangelogDate,g as handleExpandClick,c as parseChangelogLinks,d as renderChangelog,l as renderChangesSections,h as toggleChangelogExpand,u as updateChangelogStats};
//# sourceMappingURL=changelog-DmruMn9K.js.map
